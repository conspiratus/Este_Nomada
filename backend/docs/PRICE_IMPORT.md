# Импорт цен ингредиентов

Система позволяет автоматически импортировать цены ингредиентов из файлов CSV или Excel от различных поставщиков (Carrefour, Alcampo, Makro Cash & Carry и др.).

## Подготовка файла

### Формат CSV

Файл должен содержать следующие колонки:
- `name` - название ингредиента (должно точно совпадать с названием в системе)
- `price` - цена (число, можно использовать точку или запятую)
- `quantity` (опционально) - количество
- `unit` (опционально) - единица измерения

Пример файла `prices.csv`:
```csv
name,price,quantity,unit
Мука пшеничная,2.50,1,кг
Соль,0.85,1,кг
Лук репчатый,1.20,1,кг
Морковь,1.50,1,кг
Говядина (лопатка),12.99,1,кг
```

### Формат Excel

Аналогично CSV, но в формате Excel (.xlsx или .xls). Первая строка должна содержать заголовки колонок.

## Использование команды импорта

### Базовое использование

```bash
python manage.py import_prices --source carrefour --file prices.csv
```

### Параметры команды

- `--source` (обязательно) - название источника цен (например: carrefour, alcampo, makro)
- `--file` (обязательно) - путь к файлу с ценами
- `--name-column` - название колонки с названием продукта (по умолчанию: `name`)
- `--price-column` - название колонки с ценой (по умолчанию: `price`)
- `--quantity-column` - название колонки с количеством (по умолчанию: `quantity`)
- `--unit-column` - название колонки с единицей измерения (по умолчанию: `unit`)
- `--dry-run` - показать что будет обновлено без сохранения в БД

### Примеры использования

#### Импорт из CSV с кастомными названиями колонок

```bash
python manage.py import_prices \
  --source carrefour \
  --file /path/to/carrefour_prices.csv \
  --name-column "Название" \
  --price-column "Цена" \
  --quantity-column "Количество" \
  --unit-column "Ед. изм."
```

#### Тестовый запуск (dry-run)

```bash
python manage.py import_prices \
  --source alcampo \
  --file prices.xlsx \
  --dry-run
```

#### Импорт из Excel

```bash
python manage.py import_prices \
  --source makro \
  --file makro_prices.xlsx
```

## Получение прайс-листов от поставщиков

### Carrefour
Свяжитесь с представителями Carrefour для получения прайс-листа в формате CSV или Excel. Обычно они предоставляют файлы с ценами по запросу.

### Alcampo
Запросите прайс-лист у вашего менеджера по закупкам в Alcampo. Они могут предоставить файл в формате Excel или CSV.

### Makro Cash & Carry
Makro обычно предоставляет прайс-листы в формате Excel для оптовых клиентов. Свяжитесь с вашим менеджером по работе с клиентами.

## Автоматизация импорта

Вы можете настроить автоматический импорт через cron или планировщик задач:

```bash
# Каждый день в 6:00 утра
0 6 * * * cd /path/to/project/backend && python manage.py import_prices --source carrefour --file /path/to/carrefour_prices.csv
```

## Обработка ошибок

Команда выводит подробную информацию о процессе импорта:
- ✅ Успешно обновленные ингредиенты
- ⚠️ Ингредиенты, которые не были найдены в системе
- ❌ Ошибки при обработке данных

## Примечания

1. Названия ингредиентов в файле должны точно совпадать с названиями в системе (регистр не важен)
2. Цены должны быть указаны в евро (€)
3. Если ингредиент не найден, он будет пропущен (проверьте название)
4. Используйте `--dry-run` для проверки перед реальным импортом

